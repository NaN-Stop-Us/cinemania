{"version":3,"file":"main-9TDiAaA-.js","sources":["../../src/js/home.js","../../src/js/lib-list.js"],"sourcesContent":["// fetchApi\nimport {\n  BASE_URL,\n  ENDPOINTS,\n  fetchMovies,\n  fetchGenres,\n  IMG_BASE_URL,\n} from './fetchApi.js';\n\n// Catalog import\nimport { showDetailsPopup, renderStarRating } from './catalog-hero.js';\n\n\n// Library import\nimport { isInLibrary, addFilm, removeFilm } from './library.js';\n\n\nconst weeklyListEl = document.querySelector('#weekly-trends-list');\nconst upcomingCard = document.getElementById('upcoming-card');\n\n\nif (weeklyListEl && upcomingCard) {\n  document.addEventListener('DOMContentLoaded', () => {\n    loadWeeklyTrends();\n    loadUpcomingMovie();\n  });\n}\n\nlet genreMap = {};\n\n\n\n// TÃ¼r verisini al\n(async () => {\n  genreMap = await fetchGenres();\n})();\nconst width = window.innerWidth;\n\nfunction getFirstThree(arr) {\n   if (width <= 767) {\n      return arr.slice(0, 1);\n    } else {\n      return arr.slice(0, 3);\n    }\n}\n\nfunction renderWeeklyCards(movies) {\n  const markup = movies\n    .map(movie => {\n      const { id, title, poster_path, release_date, vote_average, genre_ids } =\n        movie;\n      const year = release_date ? release_date.slice(0, 4) : 'N/A';\n      const poster = poster_path\n        ? `${IMG_BASE_URL}/w500${poster_path}`\n        : 'https://via.placeholder.com/395x574?text=No+Image';\n      const genres = genre_ids?.map(id => genreMap[id]).join(', ') || '';\n\n      return `\n      <li class=\"weekly-card\" data-id=\"${id}\" data-rating=\"${vote_average}\">\n        <div class=\"weekly-card__image-wrapper\">\n          <img src=\"${poster}\" alt=\"${title}\" class=\"weekly-card__image\" />\n          <div class=\"weekly-card__overlay\"></div>\n        </div>\n        <div class=\"weekly-card__info\">\n          <h3 class=\"weekly-card__title\">${title}</h3>\n          <div class=\"weekly-card__meta-row\">\n            <p class=\"weekly-card__meta\">${genres} | ${year}</p>\n            <div class=\"weekly-card__rating\"></div>\n          </div>\n        </div>\n      </li>\n    `;\n    })\n    .join('');\n\n  weeklyListEl.innerHTML = markup;\n\n  document.querySelectorAll('.weekly-card').forEach(card => {\n    const rating = parseFloat(card.dataset.rating);\n    const ratingContainer = card.querySelector('.weekly-card__rating');\n    renderStarRating(rating, ratingContainer);\n  });\n}\n\nasync function loadWeeklyTrends() {\n  try {\n    const data = await fetchMovies(BASE_URL, ENDPOINTS.TRENDING_WEEK);\n    const topThree = getFirstThree(data.results);\n    renderWeeklyCards(topThree);\n  } catch (err) {\n    weeklyListEl.innerHTML = `<p style=\"color:red;\">Failed to load movies ðŸ˜¢</p>`;\n    console.error('Fetch error:', err);\n  }\n}\n\nfunction getCurrentMonthRange() {\n  const now = new Date();\n  const year = now.getFullYear();\n  const month = now.getMonth();\n  const start = new Date(year, month, 1).toISOString().split('T')[0];\n  const end = new Date(year, month + 1, 0).toISOString().split('T')[0];\n  return { start, end };\n}\n\nasync function loadUpcomingMovie() {\n  try {\n    const { start, end } = getCurrentMonthRange();\n    const data = await fetchMovies(BASE_URL, ENDPOINTS.UPCOMING_MOVIES);\n    const filtered = data.results.filter(\n      movie => movie.release_date >= start && movie.release_date <= end\n    );\n\n    if (!filtered.length) {\n      upcomingCard.innerHTML = `<p class=\"upcoming__info\">No upcoming movies found this month.</p>`;\n      return;\n    }\n\n    const movie = filtered[Math.floor(Math.random() * filtered.length)];\n\n    const image = movie.backdrop_path\n      ? `${IMG_BASE_URL}/original${movie.backdrop_path}`\n      : 'https://via.placeholder.com/800x450';\n\n    const genreNames = movie.genre_ids\n      .map(id => genreMap[id] || 'Unknown')\n      .join(', ');\n\n    const inLibrary = isInLibrary(movie.id);\n    upcomingCard.innerHTML = `\n      <img class=\"upcoming__img\" src=\"${image}\" alt=\"${movie.title}\" />\n      <div class=\"upcoming__info\">\n        <h3>${movie.title}</h3>\n        <p><strong>Release date:</strong> <span>${movie.release_date}</span></p>\n        <p><strong>Vote / Votes:</strong> <span>${movie.vote_average.toFixed(\n          1\n        )}</span> / <span>${movie.vote_count}</span></p>\n        <p><strong>Popularity:</strong> ${movie.popularity.toFixed(1)}</p>\n        <p><strong>Genre:</strong> ${genreNames}</p>\n        <p><strong>ABOUT</strong></p>\n        <p>${movie.overview}</p>\n        <button class=\"add-library\" data-id=\"${movie.id}\">\n            ${\n              inLibrary ? 'Remove from My Library' : 'Add to My Library'\n            } </button>\n      </div>\n    `;\nconst addBtn = upcomingCard.querySelector('.add-library');\n    addBtn.addEventListener('click', () => {\n      if (isInLibrary(movie.id)) {\n        removeFilm(movie.id);\n        addBtn.textContent = 'Add to My Library';\n      } else {\n        addFilm(movie);\n        addBtn.textContent = 'Remove from My Library';\n      }\n      if (typeof onLibraryChange === 'function') {\n        onLibraryChange();\n      }\n    });\n  } catch (err) {\n    upcomingCard.innerHTML = `<p class=\"upcoming__info\">Oops! Something went wrong while loading the movie.</p>`;\n    console.error(err);\n  }\n}\n\n\n\n\n  // Ensure weeklyListEl is not null before adding the event listener\n if (weeklyListEl) {\n  weeklyListEl.addEventListener('click', async e => {\n    const card = e.target.closest('.weekly-card');\n    if (!card) return;\n    const movieId = Number(card.dataset.id);\n    if (!movieId) return;\n    try {\n      const data = await fetchMovies(BASE_URL, ENDPOINTS.TRENDING_WEEK);\n      const movie = data.results.find(film => film.id === movieId);\n      if (movie) showDetailsPopup(movie); // :white_check_mark: popup burada aÃ§Ä±lÄ±yor\n    } catch (error) {\n      console.error('Modal error:', error);\n    }\n  });\n}","import { showDetailsPopup, renderStarRating } from './catalog-hero.js';\nimport { fetchGenres } from './fetchApi.js';\n\nconst LIBRARY_KEY = 'myLibrary';\nconst filmList = document.getElementById('library-film-list');\nconst emptySection = document.getElementById('empty-library');\nconst loadMoreBtn = document.getElementById('load-more-btn');\nconst genreSelect = document.getElementById('genre-filter');\nconst genreSelectContainer = document.querySelector('.genre-container');\n\nlet genreMap = {};\nlet allFilms = [];\nlet filmsToShow = [];\nlet currentIndex = 0;\nconst PAGE_SIZE = 9;\n\n// Genre'leri getir\nfetchGenres().then(map => {\n  genreMap = map;\n  renderLibraryFilms(true); // ilk yÃ¼kleme\n});\n\n// Filmleri gÃ¶ster\nfunction renderLibraryFilms(reset = false) {\n  if (reset) {\n    allFilms = JSON.parse(localStorage.getItem(LIBRARY_KEY)) || [];\n    filmsToShow = allFilms;\n    currentIndex = 0;\n    if (filmList) filmList.innerHTML = '';\n  }\n\n  if (filmsToShow.length === 0) {\n    if (emptySection) emptySection.classList.add('hidden');\n\n    if (filmList) {\n      filmList.innerHTML = `\n        <li class=\"empty-message only-message\">\n          <p>OOPS...<br />We are very sorry!<br />You donâ€™t have any movies at your library.</p>\n          <button class=\"search-movie\" onclick=\"window.location.href='catalog.html'\">Search movie</button>\n        </li>`;\n      filmList.classList.add('only-empty');\n    }\n\n    if (loadMoreBtn) loadMoreBtn.style.display = 'none';\n    if (genreSelectContainer) genreSelectContainer.style.display = 'none';\n    return;\n  }\n\n  if (filmList) {\n    filmList.classList.remove('only-empty');\n  }\n  if (emptySection) emptySection.classList.add('hidden');\n  if (genreSelectContainer) genreSelectContainer.style.display = '';\n\n  const nextFilms = filmsToShow.slice(currentIndex, currentIndex + PAGE_SIZE);\n\n  nextFilms.forEach(film => {\n    const {\n      title,\n      poster_path,\n      release_date,\n      vote_average,\n      genre_ids,\n      genres,\n    } = film;\n\n    const year = release_date ? release_date.slice(0, 4) : 'N/A';\n    const poster = poster_path\n      ? `https://image.tmdb.org/t/p/w500${poster_path}`\n      : 'https://via.placeholder.com/395x574?text=No+Image';\n\n    const genreText =\n      Array.isArray(genres) && genres.length\n        ? genres.join(', ')\n        : Array.isArray(genre_ids) && genre_ids.length\n        ? genre_ids.map(id => genreMap[id] || id).join(', ')\n        : '';\n\n    const li = document.createElement('li');\n    li.className = 'weekly-card';\n    li.innerHTML = `\n      <div class=\"weekly-card__image-wrapper\">\n        <img class=\"weekly-card__image\" src=\"${poster}\" alt=\"${title}\">\n        <div class=\"weekly-card__overlay\"></div>\n      </div>\n      <div class=\"weekly-card__info\">\n        <h3 class=\"weekly-card__title\">${title}</h3>\n        <div class=\"weekly-card__meta-row\">\n          <p class=\"weekly-card__meta\">${genreText} | ${year}</p>\n          <div class=\"weekly-card__rating\"></div>\n        </div>\n      </div>\n    `;\n\n    const ratingContainer = li.querySelector('.weekly-card__rating');\n    renderStarRating(vote_average, ratingContainer);\n\n    li.addEventListener('click', () => {\n      showDetailsPopup(film, () => renderLibraryFilms(true));\n    });\n\n    filmList.appendChild(li);\n  });\n\n  currentIndex += PAGE_SIZE;\n\n  if (loadMoreBtn) {\n    loadMoreBtn.style.display = currentIndex < filmsToShow.length ? 'block' : 'none';\n  }\n}\n\n// Load More butonu\nif (loadMoreBtn) {\n  loadMoreBtn.addEventListener('click', () => {\n    renderLibraryFilms(); // reset = false\n  });\n}\n\n// Filtreleme\nif (genreSelect) {\n  genreSelect.addEventListener('change', () => {\n    const selectedGenre = genreSelect.value;\n    const allLibraryFilms = JSON.parse(localStorage.getItem(LIBRARY_KEY)) || [];\n\n    if (selectedGenre === 'Genre') {\n      filmsToShow = allLibraryFilms;\n      renderLibraryFilms(true);\n      return;\n    }\n\n    const filtered = allLibraryFilms.filter(film => {\n      if (Array.isArray(film.genres) && film.genres.includes(selectedGenre)) return true;\n      if (Array.isArray(film.genre_ids) && genreMap) {\n        return film.genre_ids.some(id => genreMap[id] === selectedGenre);\n      }\n      return false;\n    });\n\n    filmsToShow = filtered;\n    currentIndex = 0;\n    if (filmList) filmList.innerHTML = '';\n    renderLibraryFilms();\n  });\n}\n\n// Sayfa yÃ¼klendiÄŸinde baÅŸlat\ndocument.addEventListener('DOMContentLoaded', () => {\n  renderLibraryFilms(true);\n});\n"],"names":["weeklyListEl","upcomingCard","loadWeeklyTrends","loadUpcomingMovie","genreMap","fetchGenres","width","getFirstThree","arr","renderWeeklyCards","movies","markup","movie","id","title","poster_path","release_date","vote_average","genre_ids","year","poster","IMG_BASE_URL","genres","card","rating","ratingContainer","renderStarRating","data","fetchMovies","BASE_URL","ENDPOINTS","topThree","err","getCurrentMonthRange","now","month","start","end","filtered","image","genreNames","inLibrary","isInLibrary","addBtn","removeFilm","addFilm","e","movieId","film","showDetailsPopup","error","LIBRARY_KEY","filmList","emptySection","loadMoreBtn","genreSelect","genreSelectContainer","allFilms","filmsToShow","currentIndex","PAGE_SIZE","map","renderLibraryFilms","reset","genreText","li","selectedGenre","allLibraryFilms"],"mappings":"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"}
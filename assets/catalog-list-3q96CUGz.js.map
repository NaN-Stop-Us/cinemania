{"version":3,"file":"catalog-list-3q96CUGz.js","sources":["../../src/js/catalog-list.js"],"sourcesContent":["import {\n  fetchMovies,\n  BASE_URL,\n  ENDPOINTS,\n  IMG_BASE_URL,\n  fetchGenres,\n} from './fetchApi.js';\nimport { renderStarRating } from './catalog-hero.js';\n\nconst searchInput = document.getElementById('searchInput');\nconst yearFilter = document.getElementById('yearFilter');\nconst searchBtn = document.getElementById('searchBtn');\nconst movieResults = document.getElementById('movieResults');\nconst noResult = document.getElementById('noResult');\n\nlet currentPage = 1;\nlet totalPages = 1;\n\n// Sayfa ilk yüklendiğinde upcoming filmleri getir\ndocument.addEventListener('DOMContentLoaded', async () => {\n  try {\n    const data = await fetchMovies(BASE_URL, ENDPOINTS.UPCOMING_MOVIES, {\n      page: currentPage,\n    });\n    totalPages = data.total_pages;\n    renderMovies(data.results);\n    renderPagination(currentPage, totalPages);\n  } catch (error) {\n    noResult.innerHTML =\n      '<p>OOPS... We are very sorry! We don`t have any results matching your search. </p>';\n    console.error('Upcoming fetch hatası:', error);\n  }\n});\n\n// sayfanın genre çekme\nlet genreMap = {};\n\ndocument.addEventListener('DOMContentLoaded', async () => {\n  try {\n    genreMap = await fetchGenres(); // tür verisi buradan geliyor\n    const data = await fetchMovies(BASE_URL, ENDPOINTS.UPCOMING_MOVIES);\n    renderMovies(data.results);\n  } catch (error) {\n    movieResults.innerHTML = '<p>Film verileri yüklenemedi.</p>';\n    console.error('Hata:', error);\n  }\n});\n\n// Arama fonksiyonunu ayrı tanımla ki hem buton hem enter çağırabilsin\nasync function handleSearch() {\n  const query = searchInput.value.trim();\n  const year = yearFilter.value;\n\n  if (!query) return;\n\n  currentQuery = query;\n  currentYear = year;\n\n  try {\n    const data = await fetchMovies(BASE_URL, ENDPOINTS.SEARCH_MOVIES, {\n      query,\n      year,\n    });\n\n    renderMovies(data.results);\n  } catch (error) {\n    noResult.innerHTML =\n      '<p>OOPS... We are very sorry! We don`t have any results matching your search. </p>';\n    console.error('Search fetch hatası:', error);\n  }\n}\n\n// Butona tıklanınca\nsearchBtn.addEventListener('click', handleSearch);\n\n// Enter tuşuna basınca\nsearchInput.addEventListener('keydown', event => {\n  if (event.key === 'Enter') {\n    handleSearch();\n  }\n});\n\n// sayfa fonksiyonu\n\nfunction renderPagination(current, total) {\n  const pagination = document.getElementById('pagination');\n  pagination.innerHTML = '';\n\n  const createBtn = (text, page, isActive = false) => {\n    const btn = document.createElement('button');\n    btn.textContent = text;\n    btn.className = 'page-btn';\n    if (isActive) btn.classList.add('active');\n    btn.addEventListener('click', () => {\n      if (page !== currentPage) {\n        currentPage = page;\n        loadUpcomingPage(page);\n      }\n    });\n    return btn;\n  };\n\n  // ⏮ İlk sayfaya dön (yalnızca current > 1 ise göster)\n  if (current > 1) {\n    pagination.appendChild(createBtn('⏮', 1));\n    pagination.appendChild(createBtn('‹', current - 1));\n  }\n  const maxVisible = 3;\n  const start = Math.max(1, current - 1);\n  const end = Math.min(total, start + maxVisible - 1);\n\n  for (let i = start; i <= end; i++) {\n    pagination.appendChild(\n      createBtn(String(i).padStart(2, '0'), i, i === current)\n    );\n  }\n\n  if (end < total) {\n    const dots = document.createElement('span');\n    dots.textContent = '...';\n    dots.style.color = '#aaa';\n    pagination.appendChild(dots);\n    pagination.appendChild(createBtn(String(total).padStart(2, '0'), total));\n  }\n\n  if (current < total) {\n    pagination.appendChild(createBtn('›', current + 1));\n    pagination.appendChild(createBtn('⏭', total));\n  }\n}\n\nasync function loadUpcomingPage(page) {\n  try {\n    const data = await fetchMovies(BASE_URL, ENDPOINTS.UPCOMING_MOVIES, {\n      page,\n    });\n    renderMovies(data.results);\n    renderPagination(page, data.total_pages);\n  } catch (error) {\n    noResult.innerHTML =\n      '<p>OOPS... We are very sorry! We don`t have any results matching your search. </p>';\n    console.error('Upcoming fetch hatası:', error);\n  }\n}\n\n// popup fonksiyonu\nfunction showDetailsPopup(movie) {\n  const modal = document.getElementById('movie-detail-modal');\n  const poster = `${IMG_BASE_URL}${ENDPOINTS.IMG_W500}${movie.poster_path}`;\n  const genres = movie.genre_ids?.map(id => genreMap?.[id]).join(', ') || 'N/A';\n\n  modal.innerHTML = `\n    <div class=\"detail-overlay\"></div>\n    <div class=\"detail-box\" role=\"dialog\" aria-modal=\"true\">\n      <button class=\"close-span-btn-details\" aria-label=\"Close detail\"><span>&times;</span></button>\n      <div class=\"detail-content\">\n        <img src=\"${poster}\" alt=\"${movie.title}\" class=\"detail-poster\" />\n        <div class=\"detail-info\">\n          <h2>${movie.title}</h2>\n          <p><strong>Vote / Votes:</strong>\n            <span class=\"value-box\">${movie.vote_average.toFixed(1)}</span> /\n            <span class=\"value-box\">${movie.vote_count}</span>\n          </p>\n          <p><strong>Popularity:</strong> <span>${movie.popularity.toFixed(\n            1\n          )}</span></p>\n          <p><strong>Genre:</strong> <span>${genres}</span></p>\n          <p><strong>ABOUT</strong></p>\n          <div class=\"scrollable-description\">${movie.overview}</div>\n          <button class=\"add-library\">Add to My Library</button>\n        </div>\n      </div>\n    </div>\n  `;\n\n  modal.classList.add('active');\n\n  const escHandler = e => {\n    if (e.key === 'Escape') closeModal();\n  };\n  document.addEventListener('keydown', escHandler);\n\n  function closeModal() {\n    modal.classList.remove('active');\n    modal.innerHTML = '';\n    document.removeEventListener('keydown', escHandler);\n  }\n\n  modal\n    .querySelector('.close-span-btn-details')\n    .addEventListener('click', closeModal);\n  modal.querySelector('.detail-overlay').addEventListener('click', closeModal);\n}\n\n// Film kartlarını göster\nfunction renderMovies(movies) {\n  movieResults.innerHTML = '';\n\n  if (!movies || movies.length === 0) {\n    noResult.innerHTML =\n      '<p>OOPS... <br> We are very sorry! <br>  We don`t have any results matching your search. </p>';\n    return;\n  }\n\n  movies.forEach(movie => {\n    const card = document.createElement('div');\n    card.classList.add('movie-card');\n\n    card.innerHTML = `\n      <img src=\"${\n        movie.poster_path\n          ? IMG_BASE_URL + '/w500' + movie.poster_path\n          : 'https://via.placeholder.com/500x750?text=No+Image'\n      }\" alt=\"${movie.title}\" />\n      <h3>${movie.title}</h3>\n      <div class=\"star-container\"></div>\n      <div class=\"movie-meta\">\n        <span class=\"genre-text\">${getGenreText(movie.genre_ids)}</span>\n        <span class=\"year-text\">${\n          movie.release_date ? movie.release_date.split('-')[0] : 'Unknown'\n        }</span>\n      </div>\n    `;\n\n    const starContainer = card.querySelector('.star-container');\n    renderStarRating(movie.vote_average, starContainer);\n\n    // Kart tıklanınca detay popup aç\n    card.addEventListener('click', () => {\n      showDetailsPopup(movie);\n    });\n\n    movieResults.appendChild(card);\n  });\n}\n\nfunction getGenreText(ids = []) {\n  if (!Array.isArray(ids)) return '';\n  return ids\n    .map(id => genreMap[id])\n    .filter(Boolean)\n    .slice(0, 2)\n    .join(', ');\n}\n"],"names":["searchInput","yearFilter","searchBtn","movieResults","noResult","currentPage","totalPages","data","fetchMovies","BASE_URL","ENDPOINTS","renderMovies","renderPagination","error","genreMap","fetchGenres","handleSearch","query","year","event","current","total","pagination","createBtn","text","page","isActive","btn","loadUpcomingPage","maxVisible","start","end","i","dots","showDetailsPopup","movie","modal","poster","IMG_BASE_URL","genres","_a","id","escHandler","e","closeModal","movies","card","getGenreText","starContainer","renderStarRating","ids"],"mappings":"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"}
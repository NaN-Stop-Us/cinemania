{"version":3,"file":"main-DpmwlTSg.js","sources":["../../src/js/home.js","../../src/js/lib-list.js"],"sourcesContent":["// fetchApi\nimport {\n  BASE_URL,\n  ENDPOINTS,\n  fetchMovies,\n  fetchGenres,\n  IMG_BASE_URL,\n} from './fetchApi.js';\n\n// Catalog import\nimport { showDetailsPopup, renderStarRating } from './catalog-hero.js';\n\n\n// Library import\nimport { isInLibrary, addFilm, removeFilm } from './library.js';\n\n\nlet weeklyListEl = document.querySelector('#weekly-trends-list');\nlet upcomingCard = document.getElementById('upcoming-card');\nlet genreMap = {};\n\n// TÃ¼r verisini al\n(async () => {\n  genreMap = await fetchGenres();\n})();\nconst width = window.innerWidth;\nfunction getFirstThree(arr) {\n      if (width <= 767) {\n      return arr.slice(0, 1);\n    } else {\n      return arr.slice(0, 3);\n    }\n}\n\nfunction renderWeeklyCards(movies) {\n  const markup = movies\n    .map(movie => {\n      const { id, title, poster_path, release_date, vote_average, genre_ids } =\n        movie;\n      const year = release_date ? release_date.slice(0, 4) : 'N/A';\n      const poster = poster_path\n        ? `${IMG_BASE_URL}/w500${poster_path}`\n        : 'https://via.placeholder.com/395x574?text=No+Image';\n      const genres = genre_ids?.map(id => genreMap[id]).join(', ') || '';\n\n      return `\n      <li class=\"weekly-card\" data-id=\"${id}\" data-rating=\"${vote_average}\">\n        <div class=\"weekly-card__image-wrapper\">\n          <img src=\"${poster}\" alt=\"${title}\" class=\"weekly-card__image\" />\n          <div class=\"weekly-card__overlay\"></div>\n        </div>\n        <div class=\"weekly-card__info\">\n          <h3 class=\"weekly-card__title\">${title}</h3>\n          <div class=\"weekly-card__meta-row\">\n            <p class=\"weekly-card__meta\">${genres} | ${year}</p>\n            <div class=\"weekly-card__rating\"></div>\n          </div>\n        </div>\n      </li>\n    `;\n    })\n    .join('');\n\n  weeklyListEl.innerHTML = markup;\n\n  document.querySelectorAll('.weekly-card').forEach(card => {\n    const rating = parseFloat(card.dataset.rating);\n    const ratingContainer = card.querySelector('.weekly-card__rating');\n    renderStarRating(rating, ratingContainer);\n  });\n}\n\nasync function loadWeeklyTrends() {\n  try {\n    const data = await fetchMovies(BASE_URL, ENDPOINTS.TRENDING_WEEK);\n    const topThree = getFirstThree(data.results);\n    renderWeeklyCards(topThree);\n  } catch (err) {\n    weeklyListEl.innerHTML = `<p style=\"color:red;\">Failed to load movies ðŸ˜¢</p>`;\n    console.error('Fetch error:', err);\n  }\n}\n\nfunction getCurrentMonthRange() {\n  const now = new Date();\n  const year = now.getFullYear();\n  const month = now.getMonth();\n  const start = new Date(year, month, 1).toISOString().split('T')[0];\n  const end = new Date(year, month + 1, 0).toISOString().split('T')[0];\n  return { start, end };\n}\n\nasync function loadUpcomingMovie() {\n  try {\n    const { start, end } = getCurrentMonthRange();\n    const data = await fetchMovies(BASE_URL, ENDPOINTS.UPCOMING_MOVIES);\n    const filtered = data.results.filter(\n      movie => movie.release_date >= start && movie.release_date <= end\n    );\n\n    if (!filtered.length) {\n      upcomingCard.innerHTML = `<p class=\"upcoming__info\">No upcoming movies found this month.</p>`;\n      return;\n    }\n\n    const movie = filtered[Math.floor(Math.random() * filtered.length)];\n\n    const image = movie.backdrop_path\n      ? `${IMG_BASE_URL}/original${movie.backdrop_path}`\n      : 'https://via.placeholder.com/800x450';\n\n    const genreNames = movie.genre_ids\n      .map(id => genreMap[id] || 'Unknown')\n      .join(', ');\n\n    const inLibrary = isInLibrary(movie.id);\n    upcomingCard.innerHTML = `\n      <img class=\"upcoming__img\" src=\"${image}\" alt=\"${movie.title}\" />\n      <div class=\"upcoming__info\">\n        <h3>${movie.title}</h3>\n        <p><strong>Release date:</strong> <span>${movie.release_date}</span></p>\n        <p><strong>Vote / Votes:</strong> <span>${movie.vote_average.toFixed(\n          1\n        )}</span> / <span>${movie.vote_count}</span></p>\n        <p><strong>Popularity:</strong> ${movie.popularity.toFixed(1)}</p>\n        <p><strong>Genre:</strong> ${genreNames}</p>\n        <p><strong>ABOUT</strong></p>\n        <p>${movie.overview}</p>\n        <button class=\"add-library\" data-id=\"${movie.id}\">\n            ${\n              inLibrary ? 'Remove from My Library' : 'Add to My Library'\n            } </button>\n      </div>\n    `;\nconst addBtn = upcomingCard.querySelector('.add-library');\n    addBtn.addEventListener('click', () => {\n      if (isInLibrary(movie.id)) {\n        removeFilm(movie.id);\n        addBtn.textContent = 'Add to My Library';\n      } else {\n        addFilm(movie);\n        addBtn.textContent = 'Remove from My Library';\n      }\n      if (typeof onLibraryChange === 'function') {\n        onLibraryChange();\n      }\n    });\n  } catch (err) {\n    upcomingCard.innerHTML = `<p class=\"upcoming__info\">Oops! Something went wrong while loading the movie.</p>`;\n    console.error(err);\n  }\n}\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  loadWeeklyTrends();\n  loadUpcomingMovie();\n});\n\nweeklyListEl.addEventListener('click', async e => {\n  const card = e.target.closest('.weekly-card');\n  if (!card) return;\n\n  const movieId = Number(card.dataset.id);\n  if (!movieId) return;\n\n  try {\n    const data = await fetchMovies(BASE_URL, ENDPOINTS.TRENDING_WEEK);\n    const movie = data.results.find(film => film.id === movieId);\n    if (movie) showDetailsPopup(movie);\n  } catch (error) {\n    console.error('Modal error:', error);\n  }\n});\n","import { showDetailsPopup, renderStarRating } from './catalog-hero.js';\n\nimport { fetchGenres } from './fetchApi.js';\n\nlet genreMap = {};\nfetchGenres().then(map => {\n  genreMap = map;\n  renderLibraryFilms(true); // genreMap dolduktan sonra render et\n});\n\n\nconst LIBRARY_KEY = 'myLibrary';\nlet filmList = document.getElementById('library-film-list');\nlet emptySection = document.getElementById('empty-library');\nlet loadMoreBtn = document.getElementById('load-more-btn');\n\nlet allFilms = [];\nlet currentIndex = 0;\nconst PAGE_SIZE = 9;\n\n\nfunction renderLibraryFilms(reset = false, customFilms = null) {\n  if (reset) {\n    allFilms = JSON.parse(localStorage.getItem(LIBRARY_KEY)) || [];\n    currentIndex = 0;\n    filmList.innerHTML = '';\n  }\n\n  const filmsToShow = customFilms || allFilms;\n\n  // Genre select'i bul\n  const genreSelectContainer = document.querySelector('.genre-container');\n\n  if (filmsToShow.length === 0) {\n    emptySection.classList.remove('hidden');\n    filmList.innerHTML = `<div class=\"library-container\"><p>OOPS...<br />We are very sorry!<br />You donâ€™t have any movies at your library.</p>\n    <button class=\"search-movie\" onclick=\"window.location.href='catalog.html'\">Search movie</button>\n    </div>`;\n    loadMoreBtn.style.display = 'none';\n    // Genre select'i gizle\n    if (genreSelectContainer) genreSelectContainer.style.display = 'none';\n    return;\n  }\n\n  emptySection.classList.add('hidden');\n  // Genre select'i gÃ¶ster\n  if (genreSelectContainer) genreSelectContainer.style.display = '';\n\n  emptySection.classList.add('hidden');\n\n  // Sonraki 9 filmi ekle\n  const nextFilms = filmsToShow.slice(currentIndex, currentIndex + PAGE_SIZE);\n  nextFilms.forEach(film => {\n    const {\n      title,\n      poster_path,\n      release_date,\n      vote_average,\n      genre_ids,\n      genres,\n    } = film;\n    const year = release_date ? release_date.slice(0, 4) : 'N/A';\n    const poster = poster_path\n      ? `https://image.tmdb.org/t/p/w500${poster_path}`\n      : 'https://via.placeholder.com/395x574?text=No+Image';\n\n    const genreText = Array.isArray(genres) && genres.length\n      ? genres.join(', ')\n      : Array.isArray(genre_ids) && genre_ids.length\n        ? genre_ids.map(id => genreMap[id] || id).join(', ')\n        : '';\n\n    const li = document.createElement('li');\n    li.className = 'weekly-card';\n    li.innerHTML = `\n      <div class=\"weekly-card__image-wrapper\">\n        <img class=\"weekly-card__image\" src=\"${poster}\" alt=\"${title}\">\n        <div class=\"weekly-card__overlay\"></div>\n      </div>\n      <div class=\"weekly-card__info\">\n        <h3 class=\"weekly-card__title\">${title}</h3>\n        <div class=\"weekly-card__meta-row\">\n          <p class=\"weekly-card__meta\">${genreText} | ${year}</p>\n          <div class=\"weekly-card__rating\"></div>\n        </div>\n      </div>\n    `;\n\n    if (typeof renderStarRating === 'function') {\n      const ratingContainer = li.querySelector('.weekly-card__rating');\n      renderStarRating(vote_average, ratingContainer);\n    }\n\n    li.addEventListener('click', () => {\n      showDetailsPopup(film, () => renderLibraryFilms(true));\n    });\n\n    filmList.appendChild(li);\n  });\n\n  currentIndex += PAGE_SIZE;\n\n  if (currentIndex < filmsToShow.length) {\n    loadMoreBtn.style.display = 'block';\n  } else {\n    loadMoreBtn.style.display = 'none';\n  }\n}\n\n// Sayfa yÃ¼klendiÄŸinde filmleri gÃ¶ster\ndocument.addEventListener('DOMContentLoaded', () => {\n  renderLibraryFilms(true);\n});\n\n// Load more butonuna tÄ±klanÄ±nca\nloadMoreBtn.addEventListener('click', () => {\n  renderLibraryFilms();\n});\n\n\n\nconst genreSelect = document.getElementById('genre-filter');\n\ngenreSelect.addEventListener('change', () => {\n  const selectedGenre = genreSelect.value;\n  // TÃ¼m filmleri localStorage'dan al\n  const allFilms = JSON.parse(localStorage.getItem(LIBRARY_KEY)) || [];\n\n  // \"Genre\" seÃ§iliyse hepsini gÃ¶ster\n  if (selectedGenre === 'Genre') {\n    renderLibraryFilms(true);\n    return;\n  }\n\n  // Filtrele: genres veya genre_ids iÃ§inde seÃ§ili tÃ¼r var mÄ±?\n  const filteredFilms = allFilms.filter(film => {\n    // genres dizi ise (isim olarak)\n    if (Array.isArray(film.genres) && film.genres.includes(selectedGenre)) {\n      return true;\n    }\n    // genre_ids dizi ise (id olarak)\n    if (Array.isArray(film.genre_ids) && genreMap) {\n      return film.genre_ids.some(id => genreMap[id] === selectedGenre);\n    }\n    return false;\n\n\n    \n  });\n\n  currentIndex = 0;\n  filmList.innerHTML = '';\n  renderLibraryFilms(false, filteredFilms);\n});\n\n\n\n\n\n"],"names":["weeklyListEl","upcomingCard","genreMap","fetchGenres","width","getFirstThree","arr","renderWeeklyCards","movies","markup","movie","id","title","poster_path","release_date","vote_average","genre_ids","year","poster","IMG_BASE_URL","genres","card","rating","ratingContainer","renderStarRating","loadWeeklyTrends","data","fetchMovies","BASE_URL","ENDPOINTS","topThree","err","getCurrentMonthRange","now","month","start","end","loadUpcomingMovie","filtered","image","genreNames","inLibrary","isInLibrary","addBtn","removeFilm","addFilm","e","movieId","film","showDetailsPopup","error","map","renderLibraryFilms","LIBRARY_KEY","filmList","emptySection","loadMoreBtn","allFilms","currentIndex","PAGE_SIZE","reset","customFilms","filmsToShow","genreSelectContainer","genreText","li","genreSelect","selectedGenre","filteredFilms"],"mappings":"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"}
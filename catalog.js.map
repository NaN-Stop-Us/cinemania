{"version":3,"file":"catalog.js","sources":["../src/js/catalog-list.js"],"sourcesContent":["import {\n  fetchMovies,\n  BASE_URL,\n  ENDPOINTS,\n  IMG_BASE_URL,\n  fetchGenres,\n} from './fetchApi.js';\nimport { renderStarRating } from './catalog-hero.js';\n\nconst searchInput = document.getElementById('searchInput');\nconst yearFilter = document.getElementById('yearFilter');\nconst searchBtn = document.getElementById('searchBtn');\nconst movieResults = document.getElementById('movieResults');\nconst noResult = document.getElementById('noResult');\n\nlet currentPage = 1;\nlet totalPages = 1;\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  populateYearOptions(); // burası yıl select'ini dolduruyor\n});\n\n// Sayfa ilk yüklendiğinde upcoming filmleri getir\ndocument.addEventListener('DOMContentLoaded', async () => {\n  try {\n    const data = await fetchMovies(BASE_URL, ENDPOINTS.UPCOMING_MOVIES, {\n      page: currentPage,\n    });\n    totalPages = data.total_pages;\n    renderMovies(data.results);\n    renderPagination(currentPage, totalPages);\n  } catch (error) {\n    noResult.innerHTML =\n      '<p>OOPS... We are very sorry! We don`t have any results matching your search. </p>';\n    console.error('Upcoming fetch hatası:', error);\n  }\n});\n\n// sayfanın genre çekme\nlet genreMap = {};\n\ndocument.addEventListener('DOMContentLoaded', async () => {\n  try {\n    genreMap = await fetchGenres(); // tür verisi buradan geliyor\n    const data = await fetchMovies(BASE_URL, ENDPOINTS.UPCOMING_MOVIES);\n    renderMovies(data.results);\n  } catch (error) {\n    movieResults.innerHTML = '<p>Film verileri yüklenemedi.</p>';\n    console.error('Hata:', error);\n  }\n});\n\n// Arama fonksiyonunu ayrı tanımla ki hem buton hem enter çağırabilsin\nasync function handleSearch() {\n  const query = searchInput.value.trim();\n  const year = yearFilter.value;\n\n  if (!query) return;\n  let currentQuery = '';\n  let currentYear = '';\n  currentQuery = query;\n  currentYear = year;\n\n  try {\n    const data = await fetchMovies(BASE_URL, ENDPOINTS.SEARCH_MOVIES, {\n      query,\n      year,\n    });\n\n    renderMovies(data.results);\n  } catch (error) {\n    noResult.innerHTML =\n      '<p>OOPS... We are very sorry! We don`t have any results matching your search. </p>';\n    console.error('Search fetch hatası:', error);\n  }\n}\n\nconst clearBtn = document.getElementById('clearBtn');\n\nsearchInput.addEventListener('input', () => {\n  clearBtn.style.display = searchInput.value ? 'block' : 'none';\n});\n\nclearBtn.addEventListener('click', () => {\n  searchInput.value = '';\n  clearBtn.style.display = 'none';\n  searchInput.focus();\n});\n\nconst select = document.getElementById('yearFilter');\nselect.addEventListener('change', function () {\n  for (let i = 0; i < select.options.length; i++) {\n    select.options[i].style.color = 'white';\n  }\n\n  for (let option of select.options) {\n    option.style.color = '';\n    option.style.fontWeight = '';\n    option.style.fontSize = '';\n  }\n\n  const selectedOption = select.options[select.selectedIndex];\n  selectedOption.style.color = '#F87719';\n  selectedOption.style.fontWeight = '500';\n  selectedOption.style.fontSize = '24px';\n});\n\n// Butona tıklanınca\nsearchBtn.addEventListener('click', handleSearch);\n\n// Enter tuşuna basınca\nsearchInput.addEventListener('keydown', event => {\n  if (event.key === 'Enter') {\n    handleSearch();\n  }\n});\n\n// sayfa fonksiyonu\n\nfunction renderPagination(current, total) {\n  const pagination = document.getElementById('pagination');\n  pagination.innerHTML = '';\n\n  const createBtn = (\n    content,\n    page,\n    isActive = false,\n    isNavBtn = false,\n    isSvg = false\n  ) => {\n    const btn = document.createElement('button');\n\n    if (isSvg) {\n      btn.innerHTML = content; // SVG'yi içeriye HTML olarak ekliyoruz\n    } else {\n      btn.textContent = content;\n    }\n\n    if (isNavBtn) {\n      btn.className = 'nav-btn';\n    } else {\n      btn.className = 'page-btn';\n      if (isActive) btn.classList.add('active');\n    }\n\n    btn.addEventListener('click', async () => {\n      if (page !== currentPage) {\n        currentPage = page;\n        try {\n          const data = await fetchMovies(BASE_URL, ENDPOINTS.UPCOMING_MOVIES, {\n            page,\n          });\n          renderMovies(data.results);\n          renderPagination(page, data.total_pages);\n        } catch (error) {\n          noResult.innerHTML =\n            '<p>OOPS... We are very sorry! We don`t have any results matching your search. </p>';\n          console.error('Upcoming fetch hatası:', error);\n        }\n      }\n    });\n\n    return btn;\n  };\n\n  // ⏮ İlk sayfaya dön (yalnızca current > 1 ise göster)\n  if (current > 1) {\n    pagination.appendChild(\n      createBtn(\n        `<svg class= \"svgNav\" width=\"10\" height=\"18\" viewBox=\"0 0 10 18\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n      <path d=\"M8.9375 1.125L1.0625 9L8.9375 16.875\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n    </svg>`,\n        current - 1,\n        false,\n        true,\n        true // ← SVG olduğunu belirtiyoruz\n      )\n    );\n  }\n  const maxVisible = 3;\n  const start = Math.max(1, current - 1);\n  const end = Math.min(total, start + maxVisible - 1);\n\n  for (let i = start; i <= end; i++) {\n    pagination.appendChild(\n      createBtn(String(i).padStart(2, '0'), i, i === current, false)\n    );\n  }\n\n  if (end < total) {\n    const dots = document.createElement('span');\n    dots.textContent = '...';\n    dots.style.color = '#aaa';\n    pagination.appendChild(dots);\n    pagination.appendChild(\n      createBtn(String(total).padStart(2, '0'), total, false, false)\n    );\n  }\n\n  if (current < total) {\n    pagination.appendChild(\n      createBtn(\n        `<svg class=\"svgNav\" width=\"10\" height=\"18\" viewBox=\"0 0 10 18\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n      <path d=\"M1.0625 1.125L8.9375 9L1.0625 16.875\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n    </svg>`,\n        current + 1,\n        false,\n        true,\n        true // ← SVG olduğunu belirtiyoruz\n      )\n    );\n  }\n}\n\n// popup fonksiyonu\nfunction showDetailsPopup(movie) {\n  const modal = document.getElementById('movie-detail-modal');\n  const poster = `${IMG_BASE_URL}${ENDPOINTS.IMG_W500}${movie.poster_path}`;\n  const genres = movie.genre_ids?.map(id => genreMap?.[id]).join(', ') || 'N/A';\n\n  modal.innerHTML = `\n    <div class=\"detail-overlay\"></div>\n    <div class=\"detail-box\" role=\"dialog\" aria-modal=\"true\">\n      <button class=\"close-span-btn-details\" aria-label=\"Close detail\"><span>&times;</span></button>\n      <div class=\"detail-content\">\n        <img src=\"${poster}\" alt=\"${movie.title}\" class=\"detail-poster\" />\n        <div class=\"detail-info\">\n          <h2>${movie.title}</h2>\n          <p><strong>Vote / Votes:</strong>\n            <span class=\"value-box\">${movie.vote_average.toFixed(1)}</span> /\n            <span class=\"value-box\">${movie.vote_count}</span>\n          </p>\n          <p><strong>Popularity:</strong> <span>${movie.popularity.toFixed(\n            1\n          )}</span></p>\n          <p><strong>Genre:</strong> <span>${genres}</span></p>\n          <p><strong>ABOUT</strong></p>\n          <div class=\"scrollable-description\">${movie.overview}</div>\n          <button class=\"add-library\">Add to My Library</button>\n        </div>\n      </div>\n    </div>\n  `;\n\n  modal.classList.add('active');\n\n  const escHandler = e => {\n    if (e.key === 'Escape') closeModal();\n  };\n  document.addEventListener('keydown', escHandler);\n\n  function closeModal() {\n    modal.classList.remove('active');\n    modal.innerHTML = '';\n    document.removeEventListener('keydown', escHandler);\n  }\n\n  modal\n    .querySelector('.close-span-btn-details')\n    .addEventListener('click', closeModal);\n  modal.querySelector('.detail-overlay').addEventListener('click', closeModal);\n}\n\n// Film kartlarını göster\nfunction renderMovies(movies) {\n  movieResults.innerHTML = '';\n\n  if (!movies || movies.length === 0) {\n    pagination.innerHTML = ``;\n    noResult.innerHTML =\n      '<p>OOPS... <br> We are very sorry! <br>  We don`t have any results matching your search. </p>';\n    return;\n  }\n\n  movies.forEach(movie => {\n    const card = document.createElement('div');\n    card.classList.add('movie-card');\n\n    card.innerHTML = `\n      <img src=\"${\n        movie.poster_path\n          ? IMG_BASE_URL + '/w500' + movie.poster_path\n          : 'https://via.placeholder.com/500x750?text=No+Image'\n      }\" alt=\"${movie.title}\" />\n      <h3>${movie.title}</h3>\n      <div class=\"star-container\"></div>\n      <div class=\"movie-meta\">\n        <span class=\"genre-text\">${getGenreText(movie.genre_ids)}</span>\n        <span class=\"year-text\">${\n          movie.release_date ? movie.release_date.split('-')[0] : 'Unknown'\n        }</span>\n      </div>\n    `;\n\n    const starContainer = card.querySelector('.star-container');\n    renderStarRating(movie.vote_average, starContainer);\n\n    // Kart tıklanınca detay popup aç\n    card.addEventListener('click', () => {\n      showDetailsPopup(movie);\n    });\n\n    movieResults.appendChild(card);\n  });\n}\n\nfunction getGenreText(ids = []) {\n  if (!Array.isArray(ids)) return '';\n  return ids\n    .map(id => genreMap[id])\n    .filter(Boolean)\n    .slice(0, 2)\n    .join(', ');\n}\n\nfunction populateYearOptions(\n  startYear = new Date().getFullYear(),\n  endYear = 1980\n) {\n  const yearFilter = document.getElementById('yearFilter');\n\n  for (let year = startYear; year >= endYear; year--) {\n    const option = document.createElement('option');\n    option.value = year;\n    option.textContent = year;\n    yearFilter.appendChild(option);\n  }\n}\n"],"names":["searchInput","yearFilter","searchBtn","movieResults","noResult","currentPage","totalPages","populateYearOptions","data","fetchMovies","BASE_URL","ENDPOINTS","renderMovies","renderPagination","error","genreMap","fetchGenres","handleSearch","query","year","clearBtn","select","i","option","selectedOption","event","current","total","pagination","createBtn","content","page","isActive","isNavBtn","isSvg","btn","maxVisible","start","end","dots","showDetailsPopup","movie","modal","poster","IMG_BASE_URL","genres","_a","id","escHandler","e","closeModal","movies","card","getGenreText","starContainer","renderStarRating","ids","startYear","endYear"],"mappings":"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"}